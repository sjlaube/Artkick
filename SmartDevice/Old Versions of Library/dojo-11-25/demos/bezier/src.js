/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is an optimized version of Dojo, built for deployment and not for
	development. To get sources and documentation, please visit:

		http://dojotoolkit.org
*/

//>>built
require({cache:{"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(_1,_2,_3){_2.switchTo(_3);return _2;});},"dojox/gfx/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/Color","dojo/_base/sniff","dojo/_base/window","dojo/_base/array","dojo/dom","dojo/dom-construct","dojo/dom-geometry"],function(_4,_5,_6,_7,_8,_9,_a,_b,_c){var g=_5.getObject("dojox.gfx",true),b=g._base={};g._hasClass=function(_d,_e){var _f=_d.getAttribute("className");return _f&&(" "+_f+" ").indexOf(" "+_e+" ")>=0;};g._addClass=function(_10,_11){var cls=_10.getAttribute("className")||"";if(!cls||(" "+cls+" ").indexOf(" "+_11+" ")<0){_10.setAttribute("className",cls+(cls?" ":"")+_11);}};g._removeClass=function(_12,_13){var cls=_12.getAttribute("className");if(cls){_12.setAttribute("className",cls.replace(new RegExp("(^|\\s+)"+_13+"(\\s+|$)"),"$1$2"));}};b._getFontMeasurements=function(){var _14={"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,"small":0,"medium":0,"large":0,"x-large":0,"xx-large":0};var p;if(_7("ie")){_8.doc.documentElement.style.fontSize="100%";}var div=_b.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},_8.body());for(p in _14){div.style.fontSize=p;_14[p]=Math.round(div.offsetHeight*12/16)*16/12/1000;}_8.body().removeChild(div);return _14;};var _15=null;b._getCachedFontMeasurements=function(_16){if(_16||!_15){_15=b._getFontMeasurements();}return _15;};var _17=null,_18={};b._getTextBox=function(_19,_1a,_1b){var m,s,al=arguments.length;var i;if(!_17){_17=_b.create("div",{style:{position:"absolute",top:"-10000px",left:"0"}},_8.body());}m=_17;m.className="";s=m.style;s.borderWidth="0";s.margin="0";s.padding="0";s.outline="0";if(al>1&&_1a){for(i in _1a){if(i in _18){continue;}s[i]=_1a[i];}}if(al>2&&_1b){m.className=_1b;}m.innerHTML=_19;if(m["getBoundingClientRect"]){var bcr=m.getBoundingClientRect();return {l:bcr.left,t:bcr.top,w:bcr.width||(bcr.right-bcr.left),h:bcr.height||(bcr.bottom-bcr.top)};}else{return _c.getMarginBox(m);}};b._computeTextLocation=function(_1c,_1d,_1e,_1f){var loc={},_20=_1c.align;switch(_20){case "end":loc.x=_1c.x-_1d;break;case "middle":loc.x=_1c.x-_1d/2;break;default:loc.x=_1c.x;break;}var c=_1f?0.75:1;loc.y=_1c.y-_1e*c;return loc;};b._computeTextBoundingBox=function(s){if(!g._base._isRendered(s)){return {x:0,y:0,width:0,height:0};}var loc,_21=s.getShape(),_22=s.getFont()||g.defaultFont,w=s.getTextWidth(),h=g.normalizedLength(_22.size);loc=b._computeTextLocation(_21,w,h,true);return {x:loc.x,y:loc.y,width:w,height:h};};b._isRendered=function(s){var p=s.parent;while(p&&p.getParent){p=p.parent;}return p!==null;};var _23=0;b._getUniqueId=function(){var id;do{id=_4._scopeName+"xUnique"+(++_23);}while(_a.byId(id));return id;};b._fixMsTouchAction=function(_24){var r=_24.rawNode;if(typeof r.style.msTouchAction!="undefined"){r.style.msTouchAction="none";}};_5.mixin(g,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:false,kerning:true},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:false,kerning:true},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:(function(){var _25={};return function(_26){var t=_25[_26];if(t){return new t();}t=_25[_26]=new Function();t.prototype=g["default"+_26];return new t();};})(),normalizeColor:function(_27){return (_27 instanceof _6)?_27:new _6(_27);},normalizeParameters:function(_28,_29){var x;if(_29){var _2a={};for(x in _28){if(x in _29&&!(x in _2a)){_28[x]=_29[x];}}}return _28;},makeParameters:function(_2b,_2c){var i=null;if(!_2c){return _5.delegate(_2b);}var _2d={};for(i in _2b){if(!(i in _2d)){_2d[i]=_5.clone((i in _2c)?_2c[i]:_2b[i]);}}return _2d;},formatNumber:function(x,_2e){var val=x.toString();if(val.indexOf("e")>=0){val=x.toFixed(4);}else{var _2f=val.indexOf(".");if(_2f>=0&&val.length-_2f>5){val=x.toFixed(4);}}if(x<0){return val;}return _2e?" "+val:val;},makeFontString:function(_30){return _30.style+" "+_30.variant+" "+_30.weight+" "+_30.size+" "+_30.family;},splitFontString:function(str){var _31=g.getDefault("Font");var t=str.split(/\s+/);do{if(t.length<5){break;}_31.style=t[0];_31.variant=t[1];_31.weight=t[2];var i=t[3].indexOf("/");_31.size=i<0?t[3]:t[3].substring(0,i);var j=4;if(i<0){if(t[4]=="/"){j=6;}else{if(t[4].charAt(0)=="/"){j=5;}}}if(j<t.length){_31.family=t.slice(j).join(" ");}}while(false);return _31;},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return g._base._getCachedFontMeasurements()["12pt"]/12;},pt2px:function(len){return len*g.px_in_pt();},px2pt:function(len){return len/g.px_in_pt();},normalizedLength:function(len){if(len.length===0){return 0;}if(len.length>2){var _32=g.px_in_pt();var val=parseFloat(len);switch(len.slice(-2)){case "px":return val;case "pt":return val*_32;case "in":return val*72*_32;case "pc":return val*12*_32;case "mm":return val*g.mm_in_pt*_32;case "cm":return val*g.cm_in_pt*_32;}}return parseFloat(len);},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-Za-z])|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,equalSources:function(a,b){return a&&b&&a===b;},switchTo:function(_33){var ns=typeof _33=="string"?g[_33]:_33;if(ns){_9.forEach(["Group","Rect","Ellipse","Circle","Line","Polyline","Image","Text","Path","TextPath","Surface","createSurface","fixTarget"],function(_34){g[_34]=ns[_34];});if(typeof _33=="string"){g.renderer=_33;}else{_9.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(r){return (g.renderer=g[r]&&g[r].Surface===g.Surface?r:null);});}}}});return g;});},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff","dojo/_base/window","dojo/_base/config"],function(g,_35,has,win,_36){var _37=null;has.add("vml",function(_38,_39,_3a){_3a.innerHTML="<v:shape adj=\"1\"/>";var _3b=("adj" in _3a.firstChild);_3a.innerHTML="";return _3b;});return {load:function(id,_3c,_3d){if(_37&&id!="force"){_3d(_37);return;}var _3e=_36.forceGfxRenderer,_3f=!_3e&&(_35.isString(_36.gfxRenderer)?_36.gfxRenderer:"svg,vml,canvas,silverlight").split(","),_40,_41;while(!_3e&&_3f.length){switch(_3f.shift()){case "svg":if("SVGAngle" in win.global){_3e="svg";}break;case "vml":if(has("vml")){_3e="vml";}break;case "silverlight":try{if(has("ie")){_40=new ActiveXObject("AgControl.AgControl");if(_40&&_40.IsVersionSupported("1.0")){_41=true;}}else{if(navigator.plugins["Silverlight Plug-In"]){_41=true;}}}catch(e){_41=false;}finally{_40=null;}if(_41){_3e="silverlight";}break;case "canvas":if(win.global.CanvasRenderingContext2D){_3e="canvas";}break;}}if(_3e==="canvas"&&_36.canvasEvents!==false){_3e="canvasWithEvents";}if(_36.isDebug){}function _42(){_3c(["dojox/gfx/"+_3e],function(_43){g.renderer=_3e;_37=_43;_3d(_43);});};if(_3e=="svg"&&typeof window.svgweb!="undefined"){window.svgweb.addOnLoad(_42);}else{_42();}}};});},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(g,_44){var m=g.matrix={};var _45={};m._degToRad=function(_46){return _45[_46]||(_45[_46]=(Math.PI*_46/180));};m._radToDeg=function(_47){return _47/Math.PI*180;};m.Matrix2D=function(arg){if(arg){if(typeof arg=="number"){this.xx=this.yy=arg;}else{if(arg instanceof Array){if(arg.length>0){var _48=m.normalize(arg[0]);for(var i=1;i<arg.length;++i){var l=_48,r=m.normalize(arg[i]);_48=new m.Matrix2D();_48.xx=l.xx*r.xx+l.xy*r.yx;_48.xy=l.xx*r.xy+l.xy*r.yy;_48.yx=l.yx*r.xx+l.yy*r.yx;_48.yy=l.yx*r.xy+l.yy*r.yy;_48.dx=l.xx*r.dx+l.xy*r.dy+l.dx;_48.dy=l.yx*r.dx+l.yy*r.dy+l.dy;}_44.mixin(this,_48);}}else{_44.mixin(this,arg);}}}};_44.extend(m.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});_44.mixin(m,{identity:new m.Matrix2D(),flipX:new m.Matrix2D({xx:-1}),flipY:new m.Matrix2D({yy:-1}),flipXY:new m.Matrix2D({xx:-1,yy:-1}),translate:function(a,b){if(arguments.length>1){return new m.Matrix2D({dx:a,dy:b});}return new m.Matrix2D({dx:a.x,dy:a.y});},scale:function(a,b){if(arguments.length>1){return new m.Matrix2D({xx:a,yy:b});}if(typeof a=="number"){return new m.Matrix2D({xx:a,yy:a});}return new m.Matrix2D({xx:a.x,yy:a.y});},rotate:function(_49){var c=Math.cos(_49);var s=Math.sin(_49);return new m.Matrix2D({xx:c,xy:-s,yx:s,yy:c});},rotateg:function(_4a){return m.rotate(m._degToRad(_4a));},skewX:function(_4b){return new m.Matrix2D({xy:Math.tan(_4b)});},skewXg:function(_4c){return m.skewX(m._degToRad(_4c));},skewY:function(_4d){return new m.Matrix2D({yx:Math.tan(_4d)});},skewYg:function(_4e){return m.skewY(m._degToRad(_4e));},reflect:function(a,b){if(arguments.length==1){b=a.y;a=a.x;}var a2=a*a,b2=b*b,n2=a2+b2,xy=2*a*b/n2;return new m.Matrix2D({xx:2*a2/n2-1,xy:xy,yx:xy,yy:2*b2/n2-1});},project:function(a,b){if(arguments.length==1){b=a.y;a=a.x;}var a2=a*a,b2=b*b,n2=a2+b2,xy=a*b/n2;return new m.Matrix2D({xx:a2/n2,xy:xy,yx:xy,yy:b2/n2});},normalize:function(_4f){return (_4f instanceof m.Matrix2D)?_4f:new m.Matrix2D(_4f);},isIdentity:function(_50){return _50.xx==1&&_50.xy==0&&_50.yx==0&&_50.yy==1&&_50.dx==0&&_50.dy==0;},clone:function(_51){var obj=new m.Matrix2D();for(var i in _51){if(typeof (_51[i])=="number"&&typeof (obj[i])=="number"&&obj[i]!=_51[i]){obj[i]=_51[i];}}return obj;},invert:function(_52){var M=m.normalize(_52),D=M.xx*M.yy-M.xy*M.yx;M=new m.Matrix2D({xx:M.yy/D,xy:-M.xy/D,yx:-M.yx/D,yy:M.xx/D,dx:(M.xy*M.dy-M.yy*M.dx)/D,dy:(M.yx*M.dx-M.xx*M.dy)/D});return M;},_multiplyPoint:function(_53,x,y){return {x:_53.xx*x+_53.xy*y+_53.dx,y:_53.yx*x+_53.yy*y+_53.dy};},multiplyPoint:function(_54,a,b){var M=m.normalize(_54);if(typeof a=="number"&&typeof b=="number"){return m._multiplyPoint(M,a,b);}return m._multiplyPoint(M,a.x,a.y);},multiplyRectangle:function(_55,_56){var M=m.normalize(_55);_56=_56||{x:0,y:0,width:0,height:0};if(m.isIdentity(M)){return {x:_56.x,y:_56.y,width:_56.width,height:_56.height};}var p0=m.multiplyPoint(M,_56.x,_56.y),p1=m.multiplyPoint(M,_56.x,_56.y+_56.height),p2=m.multiplyPoint(M,_56.x+_56.width,_56.y),p3=m.multiplyPoint(M,_56.x+_56.width,_56.y+_56.height),_57=Math.min(p0.x,p1.x,p2.x,p3.x),_58=Math.min(p0.y,p1.y,p2.y,p3.y),_59=Math.max(p0.x,p1.x,p2.x,p3.x),_5a=Math.max(p0.y,p1.y,p2.y,p3.y);return {x:_57,y:_58,width:_59-_57,height:_5a-_58};},multiply:function(_5b){var M=m.normalize(_5b);for(var i=1;i<arguments.length;++i){var l=M,r=m.normalize(arguments[i]);M=new m.Matrix2D();M.xx=l.xx*r.xx+l.xy*r.yx;M.xy=l.xx*r.xy+l.xy*r.yy;M.yx=l.yx*r.xx+l.yy*r.yx;M.yy=l.yx*r.xy+l.yy*r.yy;M.dx=l.xx*r.dx+l.xy*r.dy+l.dx;M.dy=l.yx*r.dx+l.yy*r.dy+l.dy;}return M;},_sandwich:function(_5c,x,y){return m.multiply(m.translate(x,y),_5c,m.translate(-x,-y));},scaleAt:function(a,b,c,d){switch(arguments.length){case 4:return m._sandwich(m.scale(a,b),c,d);case 3:if(typeof c=="number"){return m._sandwich(m.scale(a),b,c);}return m._sandwich(m.scale(a,b),c.x,c.y);}return m._sandwich(m.scale(a),b.x,b.y);},rotateAt:function(_5d,a,b){if(arguments.length>2){return m._sandwich(m.rotate(_5d),a,b);}return m._sandwich(m.rotate(_5d),a.x,a.y);},rotategAt:function(_5e,a,b){if(arguments.length>2){return m._sandwich(m.rotateg(_5e),a,b);}return m._sandwich(m.rotateg(_5e),a.x,a.y);},skewXAt:function(_5f,a,b){if(arguments.length>2){return m._sandwich(m.skewX(_5f),a,b);}return m._sandwich(m.skewX(_5f),a.x,a.y);},skewXgAt:function(_60,a,b){if(arguments.length>2){return m._sandwich(m.skewXg(_60),a,b);}return m._sandwich(m.skewXg(_60),a.x,a.y);},skewYAt:function(_61,a,b){if(arguments.length>2){return m._sandwich(m.skewY(_61),a,b);}return m._sandwich(m.skewY(_61),a.x,a.y);},skewYgAt:function(_62,a,b){if(arguments.length>2){return m._sandwich(m.skewYg(_62),a,b);}return m._sandwich(m.skewYg(_62),a.x,a.y);}});g.Matrix2D=m.Matrix2D;return m;});},"dojox/gfx/utils":function(){define(["dojo/_base/kernel","dojo/_base/lang","./_base","dojo/_base/html","dojo/_base/array","dojo/_base/window","dojo/_base/json","dojo/_base/Deferred","dojo/_base/sniff","require","dojo/_base/config"],function(_63,_64,g,_65,arr,win,_66,_67,has,_68,_69){var gu=g.utils={};_64.mixin(gu,{forEach:function(_6a,f,o){o=o||_63.global;f.call(o,_6a);if(_6a instanceof g.Surface||_6a instanceof g.Group){arr.forEach(_6a.children,function(_6b){gu.forEach(_6b,f,o);});}},serialize:function(_6c){var t={},v,_6d=_6c instanceof g.Surface;if(_6d||_6c instanceof g.Group){t.children=arr.map(_6c.children,gu.serialize);if(_6d){return t.children;}}else{t.shape=_6c.getShape();}if(_6c.getTransform){v=_6c.getTransform();if(v){t.transform=v;}}if(_6c.getStroke){v=_6c.getStroke();if(v){t.stroke=v;}}if(_6c.getFill){v=_6c.getFill();if(v){t.fill=v;}}if(_6c.getFont){v=_6c.getFont();if(v){t.font=v;}}return t;},toJson:function(_6e,_6f){return _66.toJson(gu.serialize(_6e),_6f);},deserialize:function(_70,_71){if(_71 instanceof Array){return arr.map(_71,_64.hitch(null,gu.deserialize,_70));}var _72=("shape" in _71)?_70.createShape(_71.shape):_70.createGroup();if("transform" in _71){_72.setTransform(_71.transform);}if("stroke" in _71){_72.setStroke(_71.stroke);}if("fill" in _71){_72.setFill(_71.fill);}if("font" in _71){_72.setFont(_71.font);}if("children" in _71){arr.forEach(_71.children,_64.hitch(null,gu.deserialize,_72));}return _72;},fromJson:function(_73,_74){return gu.deserialize(_73,_66.fromJson(_74));},toSvg:function(_75){var _76=new _67();if(g.renderer==="svg"){try{var svg=gu._cleanSvg(gu._innerXML(_75.rawNode));_76.callback(svg);}catch(e){_76.errback(e);}}else{if(!gu._initSvgSerializerDeferred){gu._initSvgSerializer();}var _77=gu.toJson(_75);var _78=function(){try{var _79=_75.getDimensions();var _7a=_79.width;var _7b=_79.height;var _7c=gu._gfxSvgProxy.document.createElement("div");gu._gfxSvgProxy.document.body.appendChild(_7c);win.withDoc(gu._gfxSvgProxy.document,function(){_65.style(_7c,"width",_7a);_65.style(_7c,"height",_7b);},this);var ts=gu._gfxSvgProxy[dojox._scopeName].gfx.createSurface(_7c,_7a,_7b);var _7d=function(_7e){try{gu._gfxSvgProxy[dojox._scopeName].gfx.utils.fromJson(_7e,_77);var svg=gu._cleanSvg(_7c.innerHTML);_7e.clear();_7e.destroy();gu._gfxSvgProxy.document.body.removeChild(_7c);_76.callback(svg);}catch(e){_76.errback(e);}};ts.whenLoaded(null,_7d);}catch(ex){_76.errback(ex);}};if(gu._initSvgSerializerDeferred.fired>0){_78();}else{gu._initSvgSerializerDeferred.addCallback(_78);}}return _76;},_gfxSvgProxy:null,_initSvgSerializerDeferred:null,_svgSerializerInitialized:function(){gu._initSvgSerializerDeferred.callback(true);},_initSvgSerializer:function(){if(!gu._initSvgSerializerDeferred){gu._initSvgSerializerDeferred=new _67();var f=win.doc.createElement("iframe");_65.style(f,{display:"none",position:"absolute",width:"1em",height:"1em",top:"-10000px"});var _7f;if(has("ie")){f.onreadystatechange=function(){if(f.contentWindow.document.readyState=="complete"){f.onreadystatechange=function(){};_7f=setInterval(function(){if(f.contentWindow[_63.scopeMap["dojo"][1]._scopeName]&&f.contentWindow[_63.scopeMap["dojox"][1]._scopeName].gfx&&f.contentWindow[_63.scopeMap["dojox"][1]._scopeName].gfx.utils){clearInterval(_7f);f.contentWindow.parent[_63.scopeMap["dojox"][1]._scopeName].gfx.utils._gfxSvgProxy=f.contentWindow;f.contentWindow.parent[_63.scopeMap["dojox"][1]._scopeName].gfx.utils._svgSerializerInitialized();}},50);}};}else{f.onload=function(){f.onload=function(){};_7f=setInterval(function(){if(f.contentWindow[_63.scopeMap["dojo"][1]._scopeName]&&f.contentWindow[_63.scopeMap["dojox"][1]._scopeName].gfx&&f.contentWindow[_63.scopeMap["dojox"][1]._scopeName].gfx.utils){clearInterval(_7f);f.contentWindow.parent[_63.scopeMap["dojox"][1]._scopeName].gfx.utils._gfxSvgProxy=f.contentWindow;f.contentWindow.parent[_63.scopeMap["dojox"][1]._scopeName].gfx.utils._svgSerializerInitialized();}},50);};}var uri=(_69["dojoxGfxSvgProxyFrameUrl"]||_68.toUrl("dojox/gfx/resources/gfxSvgProxyFrame.html"));f.setAttribute("src",uri.toString());win.body().appendChild(f);}},_innerXML:function(_80){if(_80.innerXML){return _80.innerXML;}else{if(_80.xml){return _80.xml;}else{if(typeof XMLSerializer!="undefined"){return (new XMLSerializer()).serializeToString(_80);}}}return null;},_cleanSvg:function(svg){if(svg){if(svg.indexOf("xmlns=\"http://www.w3.org/2000/svg\"")==-1){svg=svg.substring(4,svg.length);svg="<svg xmlns=\"http://www.w3.org/2000/svg\""+svg;}if(svg.indexOf("xmlns:xlink=\"http://www.w3.org/1999/xlink\"")==-1){svg=svg.substring(4,svg.length);svg="<svg xmlns:xlink=\"http://www.w3.org/1999/xlink\""+svg;}if(svg.indexOf("xlink:href")===-1){svg=svg.replace(/href\s*=/g,"xlink:href=");}svg=svg.replace(/<img\b([^>]*)>/gi,"<image $1 />");svg=svg.replace(/\bdojoGfx\w*\s*=\s*(['"])\w*\1/g,"");svg=svg.replace(/\b__gfxObject__\s*=\s*(['"])\w*\1/g,"");svg=svg.replace(/[=]([^"']+?)(\s|>)/g,"=\"$1\"$2");}return svg;}});return gu;});},"dojox/gfx/Moveable":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/_base/array","dojo/_base/event","dojo/topic","dojo/touch","dojo/dom-class","dojo/_base/window","./Mover"],function(_81,_82,arr,_83,_84,_85,_86,win,_87){return _82("dojox.gfx.Moveable",null,{constructor:function(_88,_89){this.shape=_88;this.delay=(_89&&_89.delay>0)?_89.delay:0;this.mover=(_89&&_89.mover)?_89.mover:_87;this.events=[this.shape.on(_85.press,_81.hitch(this,"onMouseDown"))];},destroy:function(){arr.forEach(this.events,function(_8a){_8a.remove();});this.events=this.shape=null;},onMouseDown:function(e){if(this.delay){this.events.push(this.shape.on(_85.move,_81.hitch(this,"onMouseMove")),this.shape.on(_85.release,_81.hitch(this,"onMouseUp")));this._lastX=e.clientX;this._lastY=e.clientY;}else{new this.mover(this.shape,e,this);}_83.stop(e);},onMouseMove:function(e){var _8b=e.clientX,_8c=e.clientY;if(Math.abs(_8b-this._lastX)>this.delay||Math.abs(_8c-this._lastY)>this.delay){this.onMouseUp(e);new this.mover(this.shape,e,this);}_83.stop(e);},onMouseUp:function(e){this.events.pop().remove();},onMoveStart:function(_8d){_84.publish("/gfx/move/start",_8d);_86.add(win.body(),"dojoMove");},onMoveStop:function(_8e){_84.publish("/gfx/move/stop",_8e);_86.remove(win.body(),"dojoMove");},onFirstMove:function(_8f){},onMove:function(_90,_91){this.onMoving(_90,_91);this.shape.applyLeftTransform(_91);this.onMoved(_90,_91);},onMoving:function(_92,_93){},onMoved:function(_94,_95){}});});},"dojo/touch":function(){define(["./_base/kernel","./aspect","./dom","./dom-class","./_base/lang","./on","./has","./mouse","./domReady","./_base/window"],function(_96,_97,dom,_98,_99,on,has,_9a,_9b,win){var _9c=has("touch");var _9d=has("ios")<5;var _9e=navigator.msPointerEnabled;var _9f,_a0,_a1,_a2,_a3,_a4,_a5,_a6;var _a7;function _a8(_a9,_aa,_ab){if(_9e&&_ab){return function(_ac,_ad){return on(_ac,_ab,_ad);};}else{if(_9c){return function(_ae,_af){var _b0=on(_ae,_aa,_af),_b1=on(_ae,_a9,function(evt){if(!_a7||(new Date()).getTime()>_a7+1000){_af.call(this,evt);}});return {remove:function(){_b0.remove();_b1.remove();}};};}else{return function(_b2,_b3){return on(_b2,_a9,_b3);};}}};function _b4(_b5){do{if(_b5.dojoClick){return _b5;}}while(_b5=_b5.parentNode);};function _b6(e,_b7,_b8){var _b9=_b4(e.target);_a0=!e.target.disabled&&_b9&&_b9.dojoClick;if(_a0){var _ba=(_a0=="useTarget");_a1=(_ba?_b9:e.target);if(_ba){e.preventDefault();}_a2=e.touches?e.touches[0].pageX:e.clientX;_a3=e.touches?e.touches[0].pageY:e.clientY;_a4=(typeof _a0=="object"?_a0.x:(typeof _a0=="number"?_a0:0))||4;_a5=(typeof _a0=="object"?_a0.y:(typeof _a0=="number"?_a0:0))||4;if(!_9f){_9f=true;function _bb(e){if(_ba){_a0=dom.isDescendant(win.doc.elementFromPoint((e.changedTouches?e.changedTouches[0].pageX:e.clientX),(e.changedTouches?e.changedTouches[0].pageY:e.clientY)),_a1);}else{_a0=_a0&&e.target==_a1&&Math.abs((e.changedTouches?e.changedTouches[0].pageX:e.clientX)-_a2)<=_a4&&Math.abs((e.changedTouches?e.changedTouches[0].pageY:e.clientY)-_a3)<=_a5;}};win.doc.addEventListener(_b7,function(e){_bb(e);if(_ba){e.preventDefault();}},true);win.doc.addEventListener(_b8,function(e){_bb(e);if(_a0){_a6=(new Date()).getTime();var _bc=(_ba?_a1:e.target);if(_bc.tagName==="LABEL"){_bc=dom.byId(_bc.getAttribute("for"))||_bc;}setTimeout(function(){on.emit(_bc,"click",{bubbles:true,cancelable:true,_dojo_click:true});},0);}},true);function _bd(_be){win.doc.addEventListener(_be,function(e){if(!e._dojo_click&&(new Date()).getTime()<=_a6+1000&&!(e.target.tagName=="INPUT"&&_98.contains(e.target,"dijitOffScreen"))){e.stopPropagation();e.stopImmediatePropagation&&e.stopImmediatePropagation();if(_be=="click"&&(e.target.tagName!="INPUT"||e.target.type=="radio"||e.target.type=="checkbox")&&e.target.tagName!="TEXTAREA"&&e.target.tagName!="AUDIO"&&e.target.tagName!="VIDEO"){e.preventDefault();}}},true);};_bd("click");_bd("mousedown");_bd("mouseup");}}};var _bf;if(_9c){if(_9e){_9b(function(){win.doc.addEventListener("MSPointerDown",function(evt){_b6(evt,"MSPointerMove","MSPointerUp");},true);});}else{_9b(function(){_bf=win.body();win.doc.addEventListener("touchstart",function(evt){_a7=(new Date()).getTime();var _c0=_bf;_bf=evt.target;on.emit(_c0,"dojotouchout",{relatedTarget:_bf,bubbles:true});on.emit(_bf,"dojotouchover",{relatedTarget:_c0,bubbles:true});_b6(evt,"touchmove","touchend");},true);function _c1(evt){var _c2=_99.delegate(evt,{bubbles:true});if(has("ios")>=6){_c2.touches=evt.touches;_c2.altKey=evt.altKey;_c2.changedTouches=evt.changedTouches;_c2.ctrlKey=evt.ctrlKey;_c2.metaKey=evt.metaKey;_c2.shiftKey=evt.shiftKey;_c2.targetTouches=evt.targetTouches;}return _c2;};on(win.doc,"touchmove",function(evt){_a7=(new Date()).getTime();var _c3=win.doc.elementFromPoint(evt.pageX-(_9d?0:win.global.pageXOffset),evt.pageY-(_9d?0:win.global.pageYOffset));if(_c3){if(_bf!==_c3){on.emit(_bf,"dojotouchout",{relatedTarget:_c3,bubbles:true});on.emit(_c3,"dojotouchover",{relatedTarget:_bf,bubbles:true});_bf=_c3;}if(!on.emit(_c3,"dojotouchmove",_c1(evt))){evt.preventDefault();}}});on(win.doc,"touchend",function(evt){_a7=(new Date()).getTime();var _c4=win.doc.elementFromPoint(evt.pageX-(_9d?0:win.global.pageXOffset),evt.pageY-(_9d?0:win.global.pageYOffset))||win.body();on.emit(_c4,"dojotouchend",_c1(evt));});});}}var _c5={press:_a8("mousedown","touchstart","MSPointerDown"),move:_a8("mousemove","dojotouchmove","MSPointerMove"),release:_a8("mouseup","dojotouchend","MSPointerUp"),cancel:_a8(_9a.leave,"touchcancel",_9c?"MSPointerCancel":null),over:_a8("mouseover","dojotouchover","MSPointerOver"),out:_a8("mouseout","dojotouchout","MSPointerOut"),enter:_9a._eventHandler(_a8("mouseover","dojotouchover","MSPointerOver")),leave:_9a._eventHandler(_a8("mouseout","dojotouchout","MSPointerOut"))};1&&(_96.touch=_c5);return _c5;});},"dojox/gfx/Mover":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/declare","dojo/on","dojo/touch","dojo/_base/event"],function(_c6,arr,_c7,on,_c8,_c9){return _c7("dojox.gfx.Mover",null,{constructor:function(_ca,e,_cb){this.shape=_ca;this.lastX=e.clientX;this.lastY=e.clientY;var h=this.host=_cb,d=document,_cc=on(d,_c8.move,_c6.hitch(this,"onFirstMove"));this.events=[on(d,_c8.move,_c6.hitch(this,"onMouseMove")),on(d,_c8.release,_c6.hitch(this,"destroy")),on(d,"dragstart",_c6.hitch(_c9,"stop")),on(d,"selectstart",_c6.hitch(_c9,"stop")),_cc];if(h&&h.onMoveStart){h.onMoveStart(this);}},onMouseMove:function(e){var x=e.clientX;var y=e.clientY;this.host.onMove(this,{dx:x-this.lastX,dy:y-this.lastY});this.lastX=x;this.lastY=y;_c9.stop(e);},onFirstMove:function(){this.host.onFirstMove(this);this.events.pop().remove();},destroy:function(){arr.forEach(this.events,function(_cd){_cd.remove();});var h=this.host;if(h&&h.onMoveStop){h.onMoveStop(this);}this.events=this.shape=null;}});});}}});require(["dojo/ready","dojo/on","dojo/dom","dojo/dom-geometry","dojo/mouse","dojo/_base/array","dojo/_base/event","dojox/gfx","dojox/gfx/matrix","dojox/gfx/utils","dojox/gfx/Moveable"],function(_ce,on,dom,_cf,_d0,_d1,_d2,gfx,_d3,_d4,_d5){var _d6,_d7,_d8,_d9,_da,_db,_dc,_dd,_de,_df,_e0;function _e1(p){if(_d9>1){_da[(++_d9)-1]=p;_da[(++_d9)-1]=p;_da[(++_d9)-1]=p;}else{_da[(++_d9)-1]=p;_da[(++_d9)-1]=p;}};function _e2(p){if(_d9>3){var _e3=_d9-3;var _e4=_d9-2;_da[_e3]=_e5(_da[_e4],p);}};function _e6(e){return {x:e.pageX-_d7.x,y:e.pageY-_d7.y};};function _e7(e){if(_d0.isLeft(e)&&(_de!==e.clientX||_df!==e.clientY)){_d8=true;_de=e.clientX;_df=e.clientY;if(!_da){_da=[];_d9=0;}var p=_e6(e);_e1(p);_e2(p);_da[_d9-1]=p;_e8();_e9(p);_d2.stop(e);}};function _ea(e){if(_d9>0&&_d8){var p=_e6(e);if(_d9==1){_e1(p);_e2(p);}else{_e2(p);_da[_d9-1]=p;}_eb();_d2.stop(e);}};function _ec(e){_d8=false;};function _ed(e){if(_da!=null){_ee(true);_ef();_d2.stop(e);}};function _e5(_f0,p){return {"x":_f0.x-(p.x-_f0.x),"y":_f0.y-(p.y-_f0.y)};};function _ef(){_da=null;_d9=0;_d8=false;_f1();_curveCount=0;};function _f1(){_dc.removeShape();_dd.removeShape();_db.removeShape();_ctrlLine.removeShape();};function _ee(_f2){_e0.setStroke({width:2,color:"black"});if(_f2){var val=_e0.getShape().path;val=val.slice(0,val.lastIndexOf("C"));_e0.setShape(val);}_f3();};function _f3(){_e0=_d6.createPath().setStroke({width:2,color:"red"});};function _f4(){_d7=_cf.position(_d6.rawNode,true);on(dom.byId("surface"),"mousedown",_e7);on(dom.byId("surface"),"mousemove",_ea);on(dom.byId("surface"),"mouseup",_ec);on(dom.byId("surface"),"dblclick",_ed);_db=_d6.createCircle({r:3}).setFill("black").removeShape();_dc=_f5().removeShape();_dd=_f5().removeShape();_ctrlLine=_d6.createLine().setStroke({style:"dash",color:"black"}).removeShape();_f3();};function _f5(){var _f6=_d6.createRect({width:11,height:11}).setStroke({width:1,color:"black"});return _f6;};function _e9(p){_d6.add(_db);_db.setShape({cx:p.x,cy:p.y});};function _eb(){var p;if(_curveCount>0){var val,_f7=_e0.segments[2*_curveCount-1],i=(_curveCount-1)*3,x1=_da[i].x,y1=_da[i].y,x2=_da[i+3].x,y2=_da[i+3].y,c1x=_da[i+1].x,c1y=_da[i+1].y,c2x=_da[i+2].x,c2y=_da[i+2].y,cPt={"x":c2x,"y":c2y},to={"x":x2,"y":y2},s=["C"];s.push(c1x);s.push(",");s.push(c1y);s.push(" ");s.push(c2x);s.push(",");s.push(c2y);s.push(" ");s.push(x2);s.push(",");s.push(y2);val=_e0.getShape().path;val=val.slice(0,val.lastIndexOf("C"))+s.join("");_e0.setShape(val);_f8(_dc,_dd,_ctrlLine);p=_e5(to,cPt);x1=cPt.x-6;y1=cPt.y-6;x2=p.x-6;y2=p.y-6;_dd.setShape({x:x1,y:y1});_dc.setShape({x:x2,y:y2});_ctrlLine.setShape({x1:x1+5,y1:y1+5,x2:x2+5,y2:y2+5});}else{if(_d9>1){_f8(_dc,_dd,_ctrlLine);p={x:_da[1].x,y:_da[1].y};var p2=_e5(_da[0],p);p.x-=6;p.y-=6;p2.x-=6;p2.y-=6;_dc.setShape(p);_dd.setShape(p2);_ctrlLine.setShape({x1:p.x+5,y1:p.y+5,x2:p2.x+5,y2:p2.y+5});}}};function _f8(){_d1.forEach(arguments,function(s){if(!s.getParent()){_d6.add(s);}});};function _e8(){if(_d9>4){var i=_d9-4-1;var x1=_da[i].x;var y1=_da[i].y;var x2=_da[i+3].x;var y2=_da[i+3].y;var c1x=_da[i+1].x;var c1y=_da[i+1].y;var c2x=_da[i+2].x;var c2y=_da[i+2].y;if(_curveCount++===0){_e0.moveTo(x1,y1);}_e0.curveTo(c1x,c1y,c2x,c2y,x2,y2);}};_ce(function(){var box=_cf.getContentBox(dom.byId("surface"));_d6=gfx.createSurface("surface",box.width,box.height);_f4();_ef();on(dom.byId("clear"),"click",function(){_d6.clear();_ef();_f3();});});});